# WireGuard Manager Log Rotation Configuration
# Bu dosyayı /etc/logrotate.d/wireguard-manager olarak kopyalayın
# sudo cp logrotate.conf /etc/logrotate.d/wireguard-manager

/root/wg/backend/logs/*.log {
    # Günlük rotasyon
    daily
    
    # 30 gün boyunca sakla
    rotate 30
    
    # Eski logları sıkıştır (gzip)
    compress
    
    # En son log dosyasını sıkıştırma
    delaycompress
    
    # Log dosyası yoksa hata verme
    missingok
    
    # Boş log dosyalarını rotasyona tabi tutma
    notifempty
    
    # Rotasyon sonrası yeni dosya oluştur
    create 0640 root root
    
    # Birden fazla log dosyası için paylaşılan scriptler
    sharedscripts
    
    # Rotasyon sonrası çalışacak script (servis yeniden yükle)
    postrotate
        # Backend servisini yeniden yükle (logları yeniden aç)
        systemctl reload wireguard-backend.service > /dev/null 2>&1 || true
    endscript
}

# Frontend logları için ayrı yapılandırma
/root/wg/frontend/logs/*.log {
    daily
    rotate 14
    compress
    delaycompress
    missingok
    notifempty
    create 0640 root root
    sharedscripts
    
    postrotate
        systemctl reload wireguard-frontend.service > /dev/null 2>&1 || true
    endscript
}

# Error logları için daha uzun süre saklama
/root/wg/backend/logs/*error.log {
    daily
    rotate 90
    compress
    delaycompress
    missingok
    notifempty
    create 0640 root root
}
